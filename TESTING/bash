#!/bin/bash

# Check if ssh-keygen command is available
if ! command -v ssh-keygen &> /dev/null; then
    echo "ssh-keygen command is not available. Please install Git for Windows."
    exit
fi

# Generate the SSH key with a unique name
timestamp=$(date +%Y-%m-%d_%H-%M-%S)
KEY_NAME="id_rsa_$timestamp"
ssh-keygen -t rsa -b 4096 -C "Generated by script" -N "" -f "$HOME\.ssh\\$KEY_NAME"

# Add the private key to the ssh-agent
eval $(ssh-agent -s)
ssh-add "$HOME\.ssh\\$KEY_NAME"

# Open the public key file in a text editor
if command -v notepad &> /dev/null; then
    # Use Notepad if available
    notepad "$HOME\.ssh\\$KEY_NAME.pub"
elif command -v explorer &> /dev/null; then
    # Use Explorer if available
    explorer "$HOME\.ssh\\$KEY_NAME.pub"
else
    echo "Could not find a text editor to open the public key file."
fi
